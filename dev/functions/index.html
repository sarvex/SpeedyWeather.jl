<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Function and type index · SpeedyWeather.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpeedyWeather.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../how_to_run_speedy/">How to run SpeedyWeather.jl</a></li><li><a class="tocitem" href="../spectral_transform/">Spherical harmonic transform</a></li><li><a class="tocitem" href="../dynamical_core/">Dynamical core</a></li><li><a class="tocitem" href="../parametrizations/">Parameterizations</a></li><li><a class="tocitem" href="../boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../new_model_setups/">New model setups</a></li><li class="is-active"><a class="tocitem" href>Function and type index</a><ul class="internal"><li><a class="tocitem" href="#Parameters-and-constants"><span>Parameters and constants</span></a></li><li><a class="tocitem" href="#Boundaries-and-boundary-conditions"><span>Boundaries and boundary conditions</span></a></li><li><a class="tocitem" href="#Spherical-harmonic-transform"><span>Spherical harmonic transform</span></a></li><li><a class="tocitem" href="#Dynamics"><span>Dynamics</span></a></li><li><a class="tocitem" href="#Geometry"><span>Geometry</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time stepping</span></a></li></ul></li><li><a class="tocitem" href="../conventions/">Style and convention guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Function and type index</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Function and type index</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/milankl/SpeedyWeather.jl/blob/main/docs/src/functions.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Function-and-type-index"><a class="docs-heading-anchor" href="#Function-and-type-index">Function and type index</a><a id="Function-and-type-index-1"></a><a class="docs-heading-anchor-permalink" href="#Function-and-type-index" title="Permalink"></a></h1><h2 id="Parameters-and-constants"><a class="docs-heading-anchor" href="#Parameters-and-constants">Parameters and constants</a><a id="Parameters-and-constants-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters-and-constants" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.Parameters" href="#SpeedyWeather.Parameters"><code>SpeedyWeather.Parameters</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">P = Parameters(kwargs...)</code></pre><p>A struct to hold all model parameters that may be changed by the user. The struct uses keywords such that default values can be changed at creation. The default values of the keywords define the default model setup.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/default_parameters.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.Constants" href="#SpeedyWeather.Constants"><code>SpeedyWeather.Constants</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct holding the parameters needed at runtime in number format NF.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/constants.jl#L1-L3">source</a></section></article><h2 id="Boundaries-and-boundary-conditions"><a class="docs-heading-anchor" href="#Boundaries-and-boundary-conditions">Boundaries and boundary conditions</a><a id="Boundaries-and-boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundaries-and-boundary-conditions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.Boundaries" href="#SpeedyWeather.Boundaries"><code>SpeedyWeather.Boundaries</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct that holds the boundary arrays in grid-point space     geopot<em>surf     ::Array{Complex{NF},2}  # spectral surface geopotential (orography * gravity) [m^2/s^2]     landsea</em>mask    ::Array{NF,2}           # land-sea mask, grid-point     albedo          ::Array{NF,2}           # annual mean surface albedo, grid-point</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/boundaries.jl#L1-L6">source</a></section></article><h2 id="Spherical-harmonic-transform"><a class="docs-heading-anchor" href="#Spherical-harmonic-transform">Spherical harmonic transform</a><a id="Spherical-harmonic-transform-1"></a><a class="docs-heading-anchor-permalink" href="#Spherical-harmonic-transform" title="Permalink"></a></h2><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.GeoSpectral</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.SpectralTransform" href="#SpeedyWeather.SpectralTransform"><code>SpeedyWeather.SpectralTransform</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">S = SpectralTransform{NF&lt;:AbstractFloat}(...)</code></pre><p>SpectralTransform struct that contains all parameters and preallocated arrays for the spectral transform.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_transform.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.spectral" href="#SpeedyWeather.spectral"><code>SpeedyWeather.spectral</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">alms = spectral(    map::AbstractMatrix;
                    Grid::Type{&lt;:AbstractGrid}=FullGaussianGrid,
                    kwargs...)</code></pre><p>Converts <code>map</code> to <code>grid(map)</code> to execute spectral(map::AbstractGrid;kwargs...).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_transform.jl#L572-L577">source</a></section><section><div><pre><code class="nohighlight hljs">alms = spectral(    map::AbstractGrid;
                    Grid::Type{&lt;:AbstractGrid}=FullGaussianGrid,
                    kwargs...)</code></pre><p>Converts <code>map</code> to <code>Grid(map)</code> to execute spectral(map::AbstractGrid;kwargs...).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_transform.jl#L585-L590">source</a></section><section><div><pre><code class="nohighlight hljs">alms = spectral(    map::AbstractMatrix;
                    Grid::Type{&lt;:AbstractGrid}=FullGaussianGrid,
                    kwargs...)</code></pre><p>Spectral transform (grid to spectral) <code>map</code> to <code>grid(map)</code> to execute spectral(map::AbstractGrid;kwargs...).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_transform.jl#L601-L606">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.spectral!" href="#SpeedyWeather.spectral!"><code>SpeedyWeather.spectral!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">spectral!(  alms::LowerTriangularMatrix,
            map::AbstractGrid,
            S::SpectralTransform)</code></pre><p>Spectral transform (grid to spectral space) from the gridded field <code>map</code> on a <code>grid&lt;:AbstractGrid</code> to a <code>LowerTriangularMatrix</code> of spherical harmonic coefficients <code>alms</code>. Uses FFT in the zonal direction, and a Legendre Transform in the meridional direction exploiting symmetries. The spectral transform is number format-flexible as long as the parametric types of <code>map</code>, <code>alms</code>, <code>S</code> are identical. The spectral transform is grid-flexible as long as the <code>typeof(map)&lt;:AbstractGrid</code>.  Uses the precalculated arrays, FFT plans and other constants in the SpectralTransform struct <code>S</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_transform.jl#L432-L442">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.gridded" href="#SpeedyWeather.gridded"><code>SpeedyWeather.gridded</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">map = gridded(  alms::AbstractMatrix;
                recompute_legendre::Bool=true,
                grid::Type{&lt;:AbstractGrid}=FullGaussianGrid)</code></pre><p>Spectral transform (spectral to grid space) from spherical coefficients <code>alms</code> to a newly allocated gridded field <code>map</code>. Based on the size of <code>alms</code> the grid type <code>grid</code>, the spatial resolution is retrieved based on the truncation defined for <code>grid</code>. SpectralTransform struct <code>S</code> is allocated to execute <code>gridded(alms,S)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_transform.jl#L537-L544">source</a></section><section><div><pre><code class="nohighlight hljs">map = gridded(  alms::AbstractMatrix,
                S::SpectralTransform)</code></pre><p>Spectral transform (spectral to grid space) from spherical coefficients <code>alms</code> to a newly allocated gridded field <code>map</code> with precalculated properties based on the SpectralTransform struct <code>S</code>. <code>alms</code> is converted to a <code>LowerTriangularMatrix</code> to execute the in-place <code>gridded!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_transform.jl#L555-L561">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.gridded!" href="#SpeedyWeather.gridded!"><code>SpeedyWeather.gridded!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gridded!(   map::AbstractGrid,
            alms::LowerTriangularMatrix,
            S::SpectralTransform)</code></pre><p>Spectral transform (spectral to grid) of the spherical harmonic coefficients <code>alms</code> to a gridded field <code>map</code>. The spectral transform is number format-flexible as long as the parametric types of <code>map</code>, <code>alms</code>, <code>S</code> are identical. The spectral transform is grid-flexible as long as the <code>typeof(map)&lt;:AbstractGrid</code>.  Uses the precalculated arrays, FFT plans and other constants in the SpectralTransform struct <code>S</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_transform.jl#L328-L336">source</a></section><section><div><pre><code class="nohighlight hljs">gridded!(   diagn::DiagnosticVariables{NF}, # all diagnostic variables
            progn::PrognosticVariables{NF}, # all prognostic variables
            M::BarotropicModel,             # everything that&#39;s constant
            lf::Int=1                       # leapfrog index
            ) where NF</code></pre><p>Propagate the spectral state of the prognostic variables <code>progn</code> to the diagnostic variables in <code>diagn</code> for the barotropic vorticity model. Updates grid vorticity, spectral stream function and spectral and grid velocities u,v.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/tendencies_dynamics.jl#L429-L438">source</a></section><section><div><pre><code class="nohighlight hljs">gridded!(   diagn::DiagnosticVariables{NF}, # all diagnostic variables
            progn::PrognosticVariables{NF}, # all prognostic variables
            M::ShallowWaterModel,           # everything that&#39;s constant
            lf::Int=1                       # leapfrog index
            ) where NF</code></pre><p>Propagate the spectral state of the prognostic variables <code>progn</code> to the diagnostic variables in <code>diagn</code> for the shallow water model. Updates grid vorticity, grid divergence, grid interface displacement (<code>pres_grid</code>) and the velocities U,V (scaled by cos(lat)).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/tendencies_dynamics.jl#L482-L492">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.triangular_truncation</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.roundup_fft" href="#SpeedyWeather.roundup_fft"><code>SpeedyWeather.roundup_fft</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">m = roundup_fft(n::Int;
                small_primes::Vector{Int}=[2,3,5])</code></pre><p>Returns an integer <code>m &gt;= n</code> with only small prime factors 2, 3, 5 (default, others can be specified with the keyword argument <code>small_primes</code>) to obtain an efficiently fourier-transformable number of longitudes, m = 2^i * 3^j * 5^k &gt;= n, with i,j,k &gt;=0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/utility_functions.jl#L20-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.spectral_truncation" href="#SpeedyWeather.spectral_truncation"><code>SpeedyWeather.spectral_truncation</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">alms_trunc = spectral_truncation(alms,trunc)</code></pre><p>Returns a spectral coefficient matrix <code>alms_trunc</code> that is truncated from <code>alms</code> to the size (<code>trunc</code>+1)^2. <code>alms_trunc</code> only contains those coefficient of <code>alms</code> for which m,l &lt;= trunc, and l&gt;=m are zero anyway. If <code>trunc</code> is larger than the implicit truncation in <code>alms</code> obtained from its size than <code>spectral_interpolation</code> is automatically called instead, returning <code>alms_interp</code>, a coefficient matrix that is larger than <code>alms</code> with padded zero coefficients. Also works with higher dimensional arrays, but truncation is only applied to the first two dimensions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_truncation.jl#L44-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.spectral_truncation!" href="#SpeedyWeather.spectral_truncation!"><code>SpeedyWeather.spectral_truncation!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">spectral_truncation!(alms::AbstractMatrix,ltrunc::Integer,mtrunc::Integer)</code></pre><p>Truncate spectral coefficients <code>alms</code> in-place by setting (a) the upper right triangle to zero and (b) all coefficients for which the degree <code>l</code> is larger than the truncation <code>ltrunc</code> or order <code>m</code> larger than the truncaction <code>mtrunc</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_truncation.jl#L1-L6">source</a></section><section><div><pre><code class="nohighlight hljs">spectral_truncation!(alms,trunc)</code></pre><p>Truncate spectral coefficients <code>alms</code> in-place by setting (a) the upper right triangle to zero and (b) all coefficients for which the degree l is larger than the truncation <code>trunc</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_truncation.jl#L27-L31">source</a></section><section><div><pre><code class="nohighlight hljs">spectral_truncation!(alms)</code></pre><p>Truncate spectral coefficients <code>alms</code> in-place by setting the upper right triangle to zero. This is to enforce that all coefficients for which the degree l is larger than order m are zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_truncation.jl#L37-L41">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.spectral_interpolation!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.get_legendre_polynomials!</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.∇²!" href="#SpeedyWeather.∇²!"><code>SpeedyWeather.∇²!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">∇²!(    ∇⁻²alms::LowerTriangularMatrix,
        alms::LowerTriangularMatrix,
        S::SpectralTransform)</code></pre><p>Laplace operator ∇² applied to the spectral coefficients <code>alms</code> in spherical coordinates. The radius <code>R</code> is omitted in the eigenvalues which are precomputed in <code>S</code>. ∇²! is the in-place version which directly stores the output in the first argument <code>∇²alms</code>. The spherical Laplace operator is generally</p><pre><code class="nohighlight hljs">∇⁻²alms = alms*(-l(l+1))/R²</code></pre><p>with the degree <code>l</code> (0-based) of the Legendre polynomial.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_gradients.jl#L247-L259">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.∇²</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.∇⁻²!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.∇⁻²</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.gradient_latitude!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.gradient_latitude</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.gradient_longitude!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.gradient_longitude</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.divergence!" href="#SpeedyWeather.divergence!"><code>SpeedyWeather.divergence!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">divergence!(div::LowerTriangularMatrix,
            u::LowerTriangularMatrix,
            v::LowerTriangularMatrix,
            S::SpectralTransform{NF};
            flipsign::Bool=false,
            add::Bool=false,
            )</code></pre><p>Divergence of a vector <code>u,v</code> written into <code>div</code>, <code>div = ∇⋅(u,v)</code>.  <code>u,v</code> are expected to have a 1/coslat-scaling included, then <code>div</code> is not scaled. <code>flipsign</code> option calculates -∇⋅(u,v) instead. <code>add</code> option calculates <code>div += ∇⋅(u,v)</code> instead. <code>flipsign</code> and <code>add</code> can be combined. This functions only creates the kernel and calls the generic divergence function _divergence! subsequently.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_gradients.jl#L29-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.curl!" href="#SpeedyWeather.curl!"><code>SpeedyWeather.curl!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">curl!(  curl::LowerTriangularMatrix,
        u::LowerTriangularMatrix,
        v::LowerTriangularMatrix,
        S::SpectralTransform;
        flipsign::Bool=false,
        add::Bool=false,
        )</code></pre><p>Curl of a vector <code>u,v</code> written into <code>curl</code>, <code>curl = ∇×(u,v)</code>. <code>u,v</code> are expected to have a 1/coslat-scaling included, then <code>curl</code> is not scaled. <code>flipsign</code> option calculates -∇×(u,v) instead. <code>add</code> option calculates <code>curl += ∇×(u,v)</code> instead. <code>flipsign</code> and <code>add</code> can be combined. This functions only creates the kernel and calls the generic divergence function _divergence! subsequently with flipped u,v -&gt; v,u for the curl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_gradients.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather._divergence!" href="#SpeedyWeather._divergence!"><code>SpeedyWeather._divergence!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">_divergence!(   kernel,
                div::LowerTriangularMatrix,
                u::LowerTriangularMatrix,
                v::LowerTriangularMatrix,
                S::SpectralTransform)</code></pre><p>Generic divergence function of vector <code>u</code>,<code>v</code> that writes into the output into <code>div</code>. Generic as it uses the kernel <code>kernel</code> such that curl, div, add or flipsign options are provided through <code>kernel</code>, but otherwise a single function is used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_gradients.jl#L57-L66">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.curl_div!</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.UV_from_vordiv!" href="#SpeedyWeather.UV_from_vordiv!"><code>SpeedyWeather.UV_from_vordiv!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">UV_from_vordiv!(U::LowerTriangularMatrix,
                V::LowerTriangularMatrix,
                vor::LowerTriangularMatrix,
                div::LowerTriangularMatrix,
                S::SpectralTransform)</code></pre><p>Get U,V (=(u,v)*coslat) from vorticity ζ and divergence D in spectral space. Two operations are combined into a single linear operation. First, invert the spherical Laplace ∇² operator to get stream function from vorticity and velocity potential from divergence. Then compute zonal and meridional gradients to get U,V.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_gradients.jl#L151-L162">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.UV_from_vor!" href="#SpeedyWeather.UV_from_vor!"><code>SpeedyWeather.UV_from_vor!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">UV_from_vor!(   U::LowerTriangularMatrix,
                V::LowerTriangularMatrix,
                vor::LowerTriangularMatrix,
                S::SpectralTransform)</code></pre><p>Get U,V (=(u,v)*coslat) from vorticity ζ spectral space (divergence D=0) Two operations are combined into a single linear operation. First, invert the spherical Laplace ∇² operator to get stream function from vorticity. Then compute zonal and meridional gradients to get U,V.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_gradients.jl#L100-L109">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.ϵlm" href="#SpeedyWeather.ϵlm"><code>SpeedyWeather.ϵlm</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ϵ = ϵ(NF,l,m)</code></pre><p>Recursion factors <code>ϵ</code> as a function of degree <code>l</code> and order <code>m</code> (0-based) of the spherical harmonics. ϵ(l,m) = sqrt((l^2-m^2)/(4*l^2-1)) and then converted to number format NF.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_transform.jl#L239-L243">source</a></section><section><div><pre><code class="nohighlight hljs">ϵ = ϵ(l,m)</code></pre><p>Recursion factors <code>ϵ</code> as a function of degree <code>l</code> and order <code>m</code> (0-based) of the spherical harmonics. ϵ(l,m) = sqrt((l^2-m^2)/(4*l^2-1)) with default number format Float64.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_transform.jl#L248-L252">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.get_recursion_factors" href="#SpeedyWeather.get_recursion_factors"><code>SpeedyWeather.get_recursion_factors</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_recursion_factors(  ::Type{NF}, # number format NF
                        lmax::Int,  # max degree l of spherical harmonics (0-based here)
                        mmax::Int   # max order m of spherical harmonics
                        ) where {NF&lt;:AbstractFloat}</code></pre><p>Returns a matrix of recursion factors <code>ϵ</code> up to degree <code>lmax</code> and order <code>mmax</code> of number format <code>NF</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/spectral_transform.jl#L255-L261">source</a></section></article><h2 id="Dynamics"><a class="docs-heading-anchor" href="#Dynamics">Dynamics</a><a id="Dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Dynamics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.bernoulli_potential!" href="#SpeedyWeather.bernoulli_potential!"><code>SpeedyWeather.bernoulli_potential!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">bernoulli_potential!(   D::DiagnosticVariables{NF}, # all diagnostic variables   
                        GS::GeoSpectral{NF},        # struct with geometry and spectral transform
                        g::Real                     # gravity
                        ) where {NF&lt;:AbstractFloat}</code></pre><p>Computes the Laplace operator ∇² of the Bernoulli potential <code>B</code> in spectral space. First, computes the Bernoulli potential on the grid, then transforms to spectral space and takes the Laplace operator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/tendencies_dynamics.jl#L312-L319">source</a></section><section><div><pre><code class="nohighlight hljs">bernoulli_potential!(   B::AbstractGrid,    # Output: Bernoulli potential B = 1/2*(u^2+v^2)+g*η
                        u::AbstractGrid,    # zonal velocity
                        v::AbstractGrid,    # meridional velocity
                        η::AbstractGrid,    # interface displacement
                        g::Real,            # gravity
                        G::Geometry)</code></pre><p>Computes the Bernoulli potential 1/2<em>(u^2 + v^2) + g</em>η in grid-point space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/tendencies_dynamics.jl#L337-L345">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.volume_flux_divergence!" href="#SpeedyWeather.volume_flux_divergence!"><code>SpeedyWeather.volume_flux_divergence!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">volume_fluxes!( D::DiagnosticVariables{NF},
                G::Geometry{NF},
                S::SpectralTransform{NF},
                B::Boundaries,
                H₀::Real                    # layer thickness
                ) where {NF&lt;:AbstractFloat}</code></pre><p>Computes the (negative) divergence of the volume fluxes <code>uh,vh</code> for the continuity equation, -∇⋅(uh,vh)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/tendencies_dynamics.jl#L398-L406">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.vorticity_fluxes!" href="#SpeedyWeather.vorticity_fluxes!"><code>SpeedyWeather.vorticity_fluxes!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vorticity_fluxes!(  uω_coslat⁻¹::AbstractGrid{NF},      # Output: u*(ζ+f)/coslat
                    vω_coslat⁻¹::AbstractGrid{NF},      # Output: v*(ζ+f)/coslat
                    U::AbstractGrid{NF},                # Input: u*coslat
                    V::AbstractGrid{NF},                # Input: v*coslat
                    vor::AbstractGrid{NF},              # Input: relative vorticity ζ
                    G::Geometry{NF}                     # struct with precomputed geometry arrays
                    ) where {NF&lt;:AbstractFloat}         # number format NF</code></pre><p>Compute the vorticity fluxes (u,v)*(ζ+f)/coslat in grid-point space from U,V and vorticity ζ.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/tendencies_dynamics.jl#L277-L286">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.vorticity_flux_curl!" href="#SpeedyWeather.vorticity_flux_curl!"><code>SpeedyWeather.vorticity_flux_curl!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vorticity_flux_curl!(   D::DiagnosticVariablesLayer,
                        S::SpectralTransform,
                        )</code></pre><p>Compute the curl of the vorticity fluxes ∇×(uω,vω) and store in divergence tendency. Requires vorticity_fluxes! to have been calculated already.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/tendencies_dynamics.jl#L261-L267">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.vorticity_flux_divergence!" href="#SpeedyWeather.vorticity_flux_divergence!"><code>SpeedyWeather.vorticity_flux_divergence!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vorticity_flux_divergence!( D::DiagnosticVariables{NF}, # all diagnostic variables   
                            G::GeoSpectral{NF}          # struct with geometry and spectral transform
                            ) where {NF&lt;:AbstractFloat}</code></pre><p>Compute the vorticity advection as the (negative) divergence of the vorticity fluxes -∇⋅(uv<em>(ζ+f)). First, compute the uv</em>(ζ+f), then transform to spectral space and take the divergence and flip the sign.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/tendencies_dynamics.jl#L235-L241">source</a></section></article><h2 id="Geometry"><a class="docs-heading-anchor" href="#Geometry">Geometry</a><a id="Geometry-1"></a><a class="docs-heading-anchor-permalink" href="#Geometry" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.Geometry" href="#SpeedyWeather.Geometry"><code>SpeedyWeather.Geometry</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Geometry{NF&lt;:AbstractFloat}</code></pre><p>Geometry struct containing parameters and arrays describing an iso-latitude grid &lt;:AbstractGrid and the vertical levels. NF is the number format used for the precomputed constants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/geometry.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.vertical_coordinates" href="#SpeedyWeather.vertical_coordinates"><code>SpeedyWeather.vertical_coordinates</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">σ_levels_half = vertical_coordinates(P::Parameters)</code></pre><p>Vertical sigma coordinates defined by their nlev+1 half levels <code>σ_levels_half</code>. Sigma coordinates are fraction of surface pressure (p/p0) and are sorted from top (stratosphere) to bottom (surface). The first half level is at 0 the last at 1. Evaluate a generalised logistic function with coefficients in <code>P</code> for the distribution of values in between. Default coefficients follow the L31 configuration historically used at ECMWF.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/geometry.jl#L172-L179">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.GenLogisticCoefs" href="#SpeedyWeather.GenLogisticCoefs"><code>SpeedyWeather.GenLogisticCoefs</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Coefficients of the generalised logistic function to describe the vertical coordinate. Default coefficients A,K,C,Q,B,M,ν are fitted to the old L31 configuration at ECMWF. See geometry.jl and function vertical_coordinate for more informaiton.</p><p>Following the notation of https://en.wikipedia.org/wiki/Generalised<em>logistic</em>function (Dec 15 2021).</p><p>Change default parameters for more/fewer levels in the stratosphere vs troposphere vs boundary layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/parameter_structs.jl#L3-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.generalised_logistic" href="#SpeedyWeather.generalised_logistic"><code>SpeedyWeather.generalised_logistic</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Generalised logistic function based on the coefficients in <code>coefs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/geometry.jl#L192">source</a></section></article><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.time_stepping!" href="#SpeedyWeather.time_stepping!"><code>SpeedyWeather.time_stepping!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">time_stepping!( progn::PrognosticVariables,     # all prognostic variables
                diagn::DiagnosticVariables,     # all pre-allocated diagnostic variables
                M::ModelSetup                   # all precalculated structs
                )</code></pre><p>Main time loop that that initialises output and feedback, loops over all time steps and calls the output and feedback functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/time_integration.jl#L255-L262">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.timestep!" href="#SpeedyWeather.timestep!"><code>SpeedyWeather.timestep!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">timestep!(  progn::PrognosticVariables{NF}, # all prognostic variables
            diagn::DiagnosticVariables{NF}, # all pre-allocated diagnostic variables
            dt::Real,                       # time step (mostly =2Δt, but for init steps =Δt,Δt/2)
            M::PrimitiveEquationModel,      # everything that&#39;s constant at runtime
            lf1::Int=2,                     # leapfrog index 1 (dis/enables Robert+William&#39;s filter)
            lf2::Int=2                      # leapfrog index 2 (time step used for tendencies)
            ) where {NF&lt;:AbstractFloat}</code></pre><p>Calculate a single time step for the primitive equation model of SpeedyWeather.jl </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/time_integration.jl#L115-L124">source</a></section><section><div><pre><code class="nohighlight hljs">timestep!(  progn::PrognosticVariables{NF}, # all prognostic variables
            diagn::DiagnosticVariables{NF}, # all pre-allocated diagnostic variables
            dt::Real,                       # time step (mostly =2Δt, but for init steps =Δt,Δt/2)
            M::ShallowWaterModel,           # everything that&#39;s constant at runtime
            lf1::Int=2,                     # leapfrog index 1 (dis/enables Robert+William&#39;s filter)
            lf2::Int=2                      # leapfrog index 2 (time step used for tendencies)
            ) where {NF&lt;:AbstractFloat}</code></pre><p>Calculate a single time step for the shallow water model of SpeedyWeather.jl </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/time_integration.jl#L191-L200">source</a></section><section><div><pre><code class="nohighlight hljs">timestep!(  progn::PrognosticVariables,     # all prognostic variables
            diagn::DiagnosticVariables,     # all pre-allocated diagnostic variables
            dt::Real,                       # time step (mostly =2Δt, but for init steps =Δt,Δt/2)
            lf1::Int=2,                     # leapfrog index 1 (dis/enables Robert+William&#39;s filter)
            lf2::Int=2,                     # leapfrog index 2 (time step used for tendencies)
            M::BarotropicModel,             # everything that&#39;s constant at runtime
            )</code></pre><p>Calculate a single time step for the barotropic vorticity equation model of SpeedyWeather.jl </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/time_integration.jl#L228-L237">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.first_timesteps!" href="#SpeedyWeather.first_timesteps!"><code>SpeedyWeather.first_timesteps!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">first_timesteps!(   progn::PrognosticVariables, # all prognostic variables
                    diagn::DiagnosticVariables, # all pre-allocated diagnostic variables
                    M::ModelSetup,              # everything that is constant at runtime
                    feedback::Feedback          # feedback struct
                    )</code></pre><p>Performs the first two initial time steps (Euler forward, unfiltered leapfrog) to populate the prognostic variables with two time steps (t=0,Δt) that can then be used in the normal leap frogging.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/time_integration.jl#L74-L82">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.leapfrog!" href="#SpeedyWeather.leapfrog!"><code>SpeedyWeather.leapfrog!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">leapfrog!(  A_old::LowerTriangularMatrix{Complex{NF}},      # prognostic variable at t
            A_new::LowerTriangularMatrix{Complex{NF}},      # prognostic variable at t+dt
            tendency::LowerTriangularMatrix{Complex{NF}},   # tendency (dynamics+physics) of A
            dt::Real,                                       # time step (=2Δt, but for init steps =Δt,Δt/2)
            lf::Int=2,                                      # leapfrog index to dis/enable William&#39;s filter
            C::Constants{NF},                               # struct with constants used at runtime
            ) where {NF&lt;:AbstractFloat}                     # number format NF</code></pre><p>Performs one leapfrog time step with (<code>lf=2</code>) or without (<code>lf=1</code>) Robert+William&#39;s filter (see William (2009), Montly Weather Review, Eq. 7-9).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/89fa2d16d79d302e34cc9b49b0b0be3c04c1e2f4/src/time_integration.jl#L1-L12">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../new_model_setups/">« New model setups</a><a class="docs-footer-nextpage" href="../conventions/">Style and convention guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 30 August 2022 17:34">Tuesday 30 August 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
